<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¯Ù„ÙŠÙ„ - Daleel | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©</title>
  <meta name="description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø© Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©"/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

    <!-- Meta Tags for Social Media Sharing -->
    <meta property="og:title" content="Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±ÙˆØ§Ø¯ -Ø§Ù„ØµÙˆØ© | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©">
    <meta property="og:description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© - Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ¬Ø§Ø±Ø¨ ÙˆØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©">
    <meta property="og:image" content="https://raw.githubusercontent.com/rawad-store/konozalkhair/main/preview.jpg">
    <meta property="og:url" content="https://rawad-store.github.io/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±ÙˆØ§Ø¯ -Ø§Ù„ØµÙˆØ© | Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©">
    <meta name="twitter:description" content="Ø¯Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© - Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ¬Ø§Ø±Ø¨ ÙˆØªØ³Ù‡ÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/rawad-store/rawad-store.github.io/main/preview.jpg">
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onloa

  <style>
    :root{
      --primary:#2D5F7C;--secondary:#4A90E2;--accent:#F5A623;
      --text:#333;--bg:#F8F9FA;--white:#fff;--border:#E0E0E0;
      --shadow:0 2px 12px rgba(0,0,0,.08);
      --success:#27AE60;--error:#E74C3C;
    }
    *{box-sizing:border-box} body{margin:0;font-family:'Cairo',sans-serif;background:var(--bg);color:var(--text)}
    a{color:inherit}
    header{position:sticky;top:0;z-index:50;background:var(--white);box-shadow:var(--shadow)}
    .nav{max-width:1200px;margin:auto;display:flex;align-items:center;justify-content:space-between;padding:12px 16px}
    .brand{display:flex;gap:10px;align-items:center;font-weight:700;color:var(--primary)}
    .actions{display:flex;gap:8px}
    .btn{border:none;border-radius:8px;padding:.65rem 1rem;cursor:pointer;font-family:inherit}
    .btn-primary{background:var(--primary);color:var(--white)}
    .btn-outline{background:transparent;color:var(--primary);border:2px solid var(--primary)}
    .btn-danger{background:var(--error);color:#fff}
    .btn-icon{display:inline-flex;gap:.45rem;align-items:center}
    .hero{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;padding:40px 0}
    .hero .wrap{max-width:1200px;margin:auto;padding:0 16px;display:grid;gap:16px}
    .hero h1{margin:0 0 10px}
    .stats{display:flex;gap:24px;flex-wrap:wrap}
    .stat{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);padding:12px 16px;border-radius:12px}
    .container{max-width:1200px;margin:auto;padding:24px 16px}
    .search-bar{display:flex;margin-bottom:20px;max-width:600px;margin:0 auto 30px}
    .search-bar input{flex:1;padding:12px 16px;border:2px solid var(--border);border-radius:8px 0 0 8px;font-family:inherit}
    .search-bar button{background:var(--primary);color:white;border:none;padding:0 20px;border-radius:0 8px 8px 0;cursor:pointer}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
    .card{background:#fff;border-radius:14px;box-shadow:var(--shadow);padding:14px;position:relative}
    .card img{width:100%;height:180px;object-fit:cover;border-radius:10px;margin-bottom:10px;background:#f3f3f3}
    .meta{display:flex;gap:8px;flex-wrap:wrap;font-size:.9rem;color:#555;margin:.5rem 0}
    .rating{display:flex;gap:3px;margin:8px 0;color:#FFC107}
    .reviews{margin-top:10px;border-top:1px solid var(--border);padding-top:10px}
    .review-item{background:#f9f9f9;padding:10px;border-radius:8px;margin-bottom:8px}
    .review-header{display:flex;justify-content:space-between;margin-bottom:5px}
    .empty{padding:48px;text-align:center;color:#777}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:100}
    .modal.active{display:flex}
    .modal .box{background:#fff;border-radius:14px;max-width:520px;width:92%;box-shadow:var(--shadow);overflow:hidden;max-height:90vh;overflow-y:auto}
    .box-header{padding:14px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    .box-body{padding:16px 18px}
    .row{display:grid;gap:10px}
    .row-2{grid-template-columns:1fr 1fr}
    label{font-weight:600;color:var(--primary)}
    input, select, textarea{width:100%;padding:.7rem;border:2px solid var(--border);border-radius:8px;font-family:inherit}
    textarea{min-height:100px;resize:vertical}
    .f-end{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
    .toast-wrap{position:fixed;top:16px;right:16px;z-index:200}
    .toast{background:var(--primary);color:#fff;padding:.8rem 1rem;border-radius:8px;margin-bottom:8px;box-shadow:var(--shadow)}
    .toast.error{background:var(--error)} .toast.success{background:var(--success)}
    .contact-info{background:var(--white);padding:20px;border-radius:14px;box-shadow:var(--shadow);margin-top:30px;text-align:center}
    .contact-info h3{color:var(--primary);margin-top:0}
    .contact-links{display:flex;justify-content:center;gap:20px;margin-top:15px;flex-wrap:wrap}
    .contact-link{display:flex;align-items:center;gap:8px;text-decoration:none;color:var(--text)}
    footer{background:var(--primary);color:white;text-align:center;padding:20px;margin-top:40px}
    .tabs{display:flex;gap:10px;margin-bottom:20px;border-bottom:1px solid var(--border);padding-bottom:10px}
    .tab{background:#f1f1f1;padding:8px 16px;border-radius:6px;cursor:pointer}
    .tab.active{background:var(--primary);color:white}
    @media(max-width:600px){.row-2{grid-template-columns:1fr} .stats{justify-content:center} .contact-links{flex-direction:column;align-items:center}}
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <nav class="nav">
      <div class="brand">ğŸ“ Ø¯Ù„ÙŠÙ„ <span style="font-weight:400;color:#777">| Ø¯Ù„ÙŠÙ„Ùƒ Ù„Ù„Ø®Ø¯Ù…Ø§Øª</span></div>
      <div class="actions">
        <button id="loginBtn" class="btn btn-outline btn-icon" onclick="openAuth('login')">Ø¯Ø®ÙˆÙ„</button>
        <button id="registerBtn" class="btn btn-primary btn-icon" onclick="openAuth('register')">ØªØ³Ø¬ÙŠÙ„</button>
        <button id="logoutBtn" class="btn btn-outline btn-icon" style="display:none" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
      </div>
    </nav>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="wrap">
      <div>
        <h1>Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù…Ø©</h1>
        <p style="opacity:.9">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ´Ø§Ø±Ùƒ ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†</p>
      </div>
      <div class="stats">
        <div class="stat"><b id="statServices">0</b> Ø®Ø¯Ù…Ø©</div>
        <div class="stat"><b id="statUsers">0</b> Ù…Ø³ØªØ®Ø¯Ù…</div>
        <div class="stat"><b id="statReviews">0</b> ØªÙ‚ÙŠÙŠÙ…</div>
        <div class="stat"><button id="addServiceTop" class="btn btn-primary btn-icon" style="display:none" onclick="toggleAdd()">â• Ø£Ø¶Ù Ø®Ø¯Ù…Ø©</button></div>
      </div>
    </div>
  </section>

  <!-- Search -->
  <div class="container">
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø©..." />
      <button onclick="searchServices()"><i class="fas fa-search"></i></button>
    </div>
    
    <div class="tabs">
      <div class="tab active" data-category="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</div>
      <div class="tab" data-category="Ø­ÙƒÙˆÙ…ÙŠ">Ø­ÙƒÙˆÙ…ÙŠ</div>
      <div class="tab" data-category="ØµØ­Ø©">ØµØ­Ø©</div>
      <div class="tab" data-category="ØªØ¹Ù„ÙŠÙ…">ØªØ¹Ù„ÙŠÙ…</div>
      <div class="tab" data-category="Ù…Ø§Ù„ÙŠ">Ù…Ø§Ù„ÙŠ</div>
      <div class="tab" data-category="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</div>
    </div>

    <!-- Services -->
    <div id="services" class="grid"></div>
    <div id="empty" class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø¯Ù…Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ â€” ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¶ÙŠÙ Ø®Ø¯Ù…Ø© âœ¨</div>
  </main>

  <!-- Contact Info -->
  <div class="container">
    <div class="contact-info">
      <h3>Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
      <p>ÙŠØ³Ø¹Ø¯Ù†Ø§ ØªÙˆØ§ØµÙ„ÙƒÙ… Ù…Ø¹Ù†Ø§ Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ù…Ù‚ØªØ±Ø­Ø§Øª</p>
      <div class="contact-links">
        <a href="mailto:tarek500500@gmail.com" class="contact-link">
          <i class="fas fa-envelope"></i> tarek500500@gmail.com
        </a>
        <a href="https://wa.me/+201126630356?text=Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø®Ø¯Ù…Ø§ØªÙƒÙ…" class="whatsapp-header" target="_blank" rel="noopener">
                    <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
  </div>

         <div style="text-align: center;">
                <h4 style="margin-bottom: 1.5rem; color: var(--primary-color); font-size: 1.3rem; font-weight: 600;">ØªØ§Ø¨Ø¹ÙˆÙ†Ø§ Ø¹Ù„Ù‰ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</h4>
                <div class="social-grid">
                    <a href="https://www.facebook.com/share/1FzKsPMMsG/" class="social-card" target="_blank" rel="noopener">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.facebook.com/share/18bfjxRbHH" class="social-card" target="_blank" rel="noopener">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                </div>

  <!-- Footer -->
  <footer>
    <p>Â© 2025 Ø¯Ù„ÙŠÙ„ - Daleel. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø±ÙˆØ§Ø¯ Ø¨Ø§Ù„ØµÙˆØ©</p>
  </footer>

  <!-- Add Service Modal -->
  <div id="addModal" class="modal" aria-hidden="true">
    <div class="box" role="dialog" aria-modal="true">
      <div class="box-header">
        <h3 style="margin:0">Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
        <button class="btn btn-outline" onclick="toggleAdd()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <form id="serviceForm" class="box-body">
        <div class="row">
          <label for="svcName">Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©</label>
          <input id="svcName" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬ÙˆØ§Ø² Ø³ÙØ±" required />
        </div>
        <div class="row row-2">
          <div>
            <label for="svcCat">Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="svcCat" required>
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
              <option>Ø­ÙƒÙˆÙ…ÙŠ</option><option>ØµØ­Ø©</option><option>ØªØ¹Ù„ÙŠÙ…</option><option>Ù…Ø§Ù„ÙŠ</option><option>Ø£Ø®Ø±Ù‰</option>
            </select>
          </div>
          <div>
            <label for="svcLoc">Ø§Ù„Ù…ÙƒØ§Ù†</label>
            <input id="svcLoc" placeholder="Ø§Ù„Ø´Ø±Ù‚ÙŠØ© - Ø£Ø¨ÙˆØ­Ù…Ø§Ø¯" required />
          </div>
        </div>
        <div class="row">
          <label for="svcDocs">Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
          <textarea id="svcDocs" placeholder="Ø§Ø°ÙƒØ± Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©..." required></textarea>
        </div>
        <div class="row row-2">
          <div>
            <label for="svcCost">Ø§Ù„ØªÙƒÙ„ÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input id="svcCost" placeholder="Ù…Ø«Ø§Ù„: 100 Ø¬Ù†ÙŠÙ‡"/>
          </div>
          <div>
            <label for="svcDur">Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <input id="svcDur" placeholder="Ù…Ø«Ø§Ù„: 3-5 Ø£ÙŠØ§Ù…"/>
          </div>
        </div>
        <div class="row">
          <label for="svcNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <textarea id="svcNotes" placeholder="Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…ÙÙŠØ¯Ø©..."></textarea>
        </div>
        <div class="row">
          <label for="svcImg">ØµÙˆØ±Ø© Ø§Ù„Ø®Ø¯Ù…Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <input id="svcImg" type="file" accept="image/*"/>
        </div>
        <div class="f-end">
          <button type="button" class="btn" onclick="toggleAdd()">Ø¥Ù„ØºØ§Ø¡</button>
          <button type="submit" class="btn btn-primary btn-icon">ğŸ’¾ Ø­ÙØ¸</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Review Modal -->
  <div id="reviewModal" class="modal" aria-hidden="true">
    <div class="box" role="dialog" aria-modal="true">
      <div class="box-header">
        <h3 style="margin:0">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©: <span id="reviewServiceName"></span></h3>
        <button class="btn btn-outline" onclick="closeReview()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="box-body">
        <form id="reviewForm">
          <div class="row">
            <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
            <div class="rating" id="ratingStars">
              <i class="far fa-star" data-rating="1"></i>
              <i class="far fa-star" data-rating="2"></i>
              <i class="far fa-star" data-rating="3"></i>
              <i class="far fa-star" data-rating="4"></i>
              <i class="far fa-star" data-rating="5"></i>
            </div>
            <input type="hidden" id="reviewRating" value="0" required />
          </div>
          <div class="row">
            <label for="reviewComment">Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
            <textarea id="reviewComment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø©..."></textarea>
          </div>
          <div class="row">
            <label for="reviewAccuracy">Ù‡Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©ØŸ</label>
            <select id="reviewAccuracy" required>
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</option>
              <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø©</option>
              <option value="Ø¬Ø²Ø¦ÙŠØ§Ù‹">Ø¬Ø²Ø¦ÙŠØ§Ù‹ØŒ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ«</option>
              <option value="Ù„Ø§">Ù„Ø§ØŒ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©</option>
            </select>
          </div>
          <div class="f-end">
            <button type="button" class="btn" onclick="closeReview()">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary btn-icon">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
          </div>
        </form>
        
        <div class="reviews" id="serviceReviews">
          <h4>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h4>
          <div id="reviewsList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div id="authModal" class="modal" aria-hidden="true">
    <div class="box" role="dialog" aria-modal="true">
      <div class="box-header">
        <h3 id="authTitle" style="margin:0">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <button class="btn btn-outline" onclick="closeAuth()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="box-body">
        <!-- Login -->
        <form id="loginForm" class="row" autocomplete="on">
          <div class="row">
            <label for="loginEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="loginEmail" type="email" placeholder="email@example.com" required />
          </div>
          <div class="row">
            <label for="loginPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input id="loginPass" type="password" placeholder="******" required />
          </div>
          <div class="f-end">
            <button type="submit" class="btn btn-primary btn-icon">â¡ï¸ Ø¯Ø®ÙˆÙ„</button>
          </div>
        </form>

        <!-- Register -->
        <form id="registerForm" class="row" style="display:none" autocomplete="on">
          <div class="row">
            <label for="regEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="regEmail" type="email" placeholder="email@example.com" required />
          </div>
          <div class="row row-2">
            <div>
              <label for="regPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
              <input id="regPass" type="password" minlength="6" placeholder="6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„" required />
            </div>
            <div>
              <label for="regConfirm">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
              <input id="regConfirm" type="password" minlength="6" placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />
            </div>
          </div>
          <div class="f-end">
            <button type="submit" class="btn btn-primary btn-icon">ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
          </div>
        </form>

        <div style="margin-top:10px;text-align:center">
          <a href="#" onclick="switchAuth()">ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ <span id="switchLabel">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</span></a>
        </div>
      </div>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toasts" class="toast-wrap"></div>

  <!-- Firebase + App -->
  <script type="module">
    /* ==== Firebase SDKs ==== */
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js';
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp, doc, deleteDoc, where, updateDoc, arrayUnion } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js';
    import { getStorage, ref as sRef, uploadBytes, getDownloadURL, deleteObject } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-storage.js';

    /* ==== Config (Ø®Ø§ØµØ© Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ) ==== */
    const firebaseConfig = {
      apiKey: "AIzaSyB6TzN-QHVUOwizABYxm0Y8fkqTp1qb_qA",
      authDomain: "daleel-c4204.firebaseapp.com",
      projectId: "daleel-c4204",
      storageBucket: "daleel-c4204.appspot.com",
      messagingSenderId: "864882936232",
      appId: "1:864882936232:web:5bfc14d7c0f02559d5f02d"
    };

    /* ==== Init ==== */
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    /* ==== State ==== */
    let currentUser = null;
    let services = [];
    let allServices = [];
    let currentServiceForReview = null;

    /* ==== UI Helpers ==== */
    const $ = (s, p=document) => p.querySelector(s);
    function toast(msg, type='success'){
      const el = document.createElement('div');
      el.className = `toast ${type}`;
      el.textContent = msg;
      $('#toasts').appendChild(el);
      setTimeout(()=>el.remove(), 3200);
    }

    /* ==== Auth Modal ==== */
    function openAuth(mode='login'){
      $('#authModal').classList.add('active');
      if(mode==='register'){ $('#authTitle').textContent='Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨'; $('#loginForm').style.display='none'; $('#registerForm').style.display='grid'; $('#switchLabel').textContent='ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„'; }
      else { $('#authTitle').textContent='ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„'; $('#loginForm').style.display='grid'; $('#registerForm').style.display='none'; $('#switchLabel').textContent='Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨'; }
    }
    function closeAuth(){ $('#authModal').classList.remove('active'); $('#loginForm').reset(); $('#registerForm').reset(); }
    function switchAuth(){ if($('#loginForm').style.display!=='none') openAuth('register'); else openAuth('login'); }
    window.openAuth = openAuth; window.closeAuth = closeAuth; window.switchAuth = switchAuth;

    /* ==== Add Modal ==== */
    function toggleAdd(){ 
      if(!currentUser){ toast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹','error'); openAuth('login'); return; }
      $('#addModal').classList.toggle('active');
    }
    window.toggleAdd = toggleAdd;

    /* ==== Review Modal ==== */
    function openReview(serviceId){
      if(!currentUser){ toast('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹','error'); openAuth('login'); return; }
      
      const service = services.find(s => s.id === serviceId);
      if(!service) return;
      
      currentServiceForReview = service;
      $('#reviewServiceName').textContent = service.name;
      $('#reviewRating').value = '0';
      $('#reviewComment').value = '';
      $('#reviewAccuracy').value = '';
      resetStars();
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      loadReviews(serviceId);
      
      $('#reviewModal').classList.add('active');
    }
    
    function closeReview(){
      $('#reviewModal').classList.remove('active');
      currentServiceForReview = null;
    }
    
    function resetStars(){
      const stars = $('#ratingStars').querySelectorAll('i');
      stars.forEach(star => {
        star.classList.remove('fas');
        star.classList.add('far');
      });
    }
    
    function setStars(rating){
      const stars = $('#ratingStars').querySelectorAll('i');
      stars.forEach((star, index) => {
        if(index < rating){
          star.classList.remove('far');
          star.classList.add('fas');
        } else {
          star.classList.remove('fas');
          star.classList.add('far');
        }
      });
    }
    
    // Ø¥Ø¶Ø§ÙØ© ØªÙØ§Ø¹Ù„ Ø§Ù„Ù†Ø¬ÙˆÙ…
    document.addEventListener('DOMContentLoaded', function() {
      // ØªØ£Ø¬ÙŠÙ„ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¬ÙˆÙ… Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ DOM
      setTimeout(() => {
        const stars = $('#ratingStars')?.querySelectorAll('i');
        if(stars){
          stars.forEach(star => {
            star.addEventListener('mouseenter', function() {
              const rating = parseInt(this.getAttribute('data-rating'));
              setStars(rating);
            });
            
            star.addEventListener('mouseleave', function() {
              const currentRating = parseInt($('#reviewRating').value);
              setStars(currentRating);
            });
            
            star.addEventListener('click', function() {
              const rating = parseInt(this.getAttribute('data-rating'));
              $('#reviewRating').value = rating;
              setStars(rating);
            });
          });
        }
      }, 500);
    });

    /* ==== Search and Filter ==== */
    function searchServices(){
      const searchTerm = $('#searchInput').value.trim().toLowerCase();
      filterServices(searchTerm, $('#svcCat').value);
    }
    
    function filterServices(searchTerm = '', category = ''){
      let filtered = allServices;
      
      // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
      if(category){
        filtered = filtered.filter(service => service.category === category);
      }
      
      // Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø«
      if(searchTerm){
        filtered = filtered.filter(service => 
          service.name.toLowerCase().includes(searchTerm) || 
          service.location.toLowerCase().includes(searchTerm) ||
          service.documents.toLowerCase().includes(searchTerm)
        );
      }
      
      services = filtered;
      renderServices();
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
    document.addEventListener('DOMContentLoaded', function() {
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø³Ù†Ø©
          tabs.forEach(t => t.classList.remove('active'));
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ø³Ø§Ù† Ø§Ù„Ù…Ø­Ø¯Ø¯
          this.classList.add('active');
          
          // ØªØµÙÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
          const category = this.getAttribute('data-category');
          const searchTerm = $('#searchInput').value.trim().toLowerCase();
          filterServices(searchTerm, category);
        });
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù„Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
      $('#searchInput').addEventListener('keypress', function(e) {
        if(e.key === 'Enter') searchServices();
      });
    });

    /* ==== Auth Handlers ==== */
    $('#registerForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const email = $('#regEmail').value.trim();
      const pass  = $('#regPass').value;
      const confirm = $('#regConfirm').value;
      if(pass!==confirm){ toast('ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©','error'); return; }
      try{
        await createUserWithEmailAndPassword(auth, email, pass);
        toast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­'); closeAuth();
      }catch(err){ toast(mapAuthErr(err),'error'); console.error(err); }
    });

    $('#loginForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const email = $('#loginEmail').value.trim();
      const pass  = $('#loginPass').value;
      try{
        await signInWithEmailAndPassword(auth, email, pass);
        toast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„'); closeAuth();
      }catch(err){ toast(mapAuthErr(err),'error'); console.error(err); }
    });

    function logout(){ signOut(auth).then(()=>toast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬')).catch(e=>toast('Ø®Ø·Ø£: '+e.message,'error')); }
    window.logout = logout;

    function mapAuthErr(e){
      switch(e.code){
        case 'auth/email-already-in-use': return 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„';
        case 'auth/invalid-email': return 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­';
        case 'auth/weak-password': return 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)';
        case 'auth/user-not-found': return 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯';
        case 'auth/wrong-password': return 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
        default: return e.message;
      }
    }

    onAuthStateChanged(auth, (user)=>{
      currentUser = user;
      $('#loginBtn').style.display  = user ? 'none':'inline-block';
      $('#registerBtn').style.display= user ? 'none':'inline-block';
      $('#logoutBtn').style.display = user ? 'inline-block':'none';
      $('#addServiceTop').style.display = user ? 'inline-block':'none';
      loadServices(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø­Ø°Ù Ù„Ù…Ø§Ù„ÙÙƒ Ø§Ù„Ø®Ø¯Ù…Ø©)
      loadStats();
    });

    /* ==== Add Service ==== */
    $('#serviceForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!currentUser){ toast('Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹','error'); return; }

      const name = $('#svcName').value.trim();
      const category = $('#svcCat').value;
      const location = $('#svcLoc').value.trim();
      const documents = $('#svcDocs').value.trim();
      const cost = $('#svcCost').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      const duration = $('#svcDur').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      const notes = $('#svcNotes').value.trim();
      const file = $('#svcImg').files[0];

      if(!name || !category || !location || !documents){ toast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©','error'); return; }

      try{
        let imageUrl = ''; let imagePath = '';
        if(file){
          imagePath = `services/${currentUser.uid}/${Date.now()}-${file.name}`;
          const ref = sRef(storage, imagePath);
          const snap = await uploadBytes(ref, file);
          imageUrl = await getDownloadURL(snap.ref);
        }

        await addDoc(collection(db,'services'),{
          name, category, location,
          documents, cost, duration, notes,
          imageUrl, imagePath,
          userId: currentUser.uid,
          userEmail: currentUser.email,
          reviews: [],
          averageRating: 0,
          totalReviews: 0,
          createdAt: serverTimestamp()
        });

        toast('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­','success');
        $('#serviceForm').reset(); toggleAdd(); loadServices(); loadStats();
      }catch(err){ console.error(err); toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©: '+err.message,'error'); }
    });

    /* ==== Review Handlers ==== */
    $('#reviewForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!currentUser || !currentServiceForReview){ return; }
      
      const rating = parseInt($('#reviewRating').value);
      const comment = $('#reviewComment').value.trim();
      const accuracy = $('#reviewAccuracy').value;
      
      if(!rating || !accuracy){ toast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØªØ­Ø¯ÙŠØ¯ Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª','error'); return; }
      
      try{
        const reviewData = {
          userId: currentUser.uid,
          userEmail: currentUser.email,
          rating: rating,
          comment: comment,
          accuracy: accuracy,
          createdAt: serverTimestamp()
        };
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯
        const serviceRef = doc(db, 'services', currentServiceForReview.id);
        await updateDoc(serviceRef, {
          reviews: arrayUnion(reviewData)
        });
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
        const updatedReviews = [...(currentServiceForReview.reviews || []), reviewData];
        const totalRating = updatedReviews.reduce((sum, review) => sum + review.rating, 0);
        const averageRating = totalRating / updatedReviews.length;
        
        await updateDoc(serviceRef, {
          averageRating: averageRating,
          totalReviews: updatedReviews.length
        });
        
        toast('Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø§Ù„Ø®Ø¯Ù…Ø©!','success');
        closeReview();
        loadServices(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
        loadStats(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      }catch(err){ console.error(err); toast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: '+err.message,'error'); }
    });
    
    async function loadReviews(serviceId){
      try{
        const serviceDoc = await getDocs(query(collection(db, 'services'), where('__name__', '==', serviceId)));
        if(!serviceDoc.empty){
          const serviceData = serviceDoc.docs[0].data();
          const reviews = serviceData.reviews || [];
          
          const reviewsList = $('#reviewsList');
          reviewsList.innerHTML = '';
          
          if(reviews.length === 0){
            reviewsList.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</p>';
            return;
          }
          
          // ØªØ±ØªÙŠØ¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø¯Ù…
          const sortedReviews = [...reviews].sort((a, b) => {
            return b.createdAt?.toDate() - a.createdAt?.toDate();
          });
          
          sortedReviews.forEach(review => {
            const reviewEl = document.createElement('div');
            reviewEl.className = 'review-item';
            
            const date = review.createdAt ? review.createdAt.toDate().toLocaleDateString('ar-EG') : 'ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            
            reviewEl.innerHTML = `
              <div class="review-header">
                <div>${review.userEmail || 'Ù…Ø³ØªØ®Ø¯Ù…'}</div>
                <div>${date}</div>
              </div>
              <div class="rating">
                ${renderStars(review.rating)}
              </div>
              <div><strong>Ø¯Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:</strong> ${review.accuracy}</div>
              ${review.comment ? `<div>${escapeHTML(review.comment)}</div>` : ''}
            `;
            
            reviewsList.appendChild(reviewEl);
          });
        }
      }catch(err){ console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª:', err); }
    }
    
    function renderStars(rating){
      let stars = '';
      for(let i = 1; i <= 5; i++){
        if(i <= rating){
          stars += '<i class="fas fa-star"></i>';
        } else {
          stars += '<i class="far fa-star"></i>';
        }
      }
      return stars;
    }

    /* ==== Load & Render Services ==== */
    async function loadServices(){
      try{
        const q = query(collection(db,'services'), orderBy('createdAt','desc'));
        const snap = await getDocs(q);
        services = [];
        allServices = [];
        snap.forEach(d => {
          const data = d.data();
          services.push({ id:d.id, ...data });
          allServices.push({ id:d.id, ...data });
        });
        renderServices();
      }catch(err){ console.error(err); toast('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª','error'); }
    }

    function renderServices(){
      const wrap = $('#services'); wrap.innerHTML = '';
      if(services.length===0){ $('#empty').style.display='block'; return; }
      $('#empty').style.display='none';

      services.forEach(s=>{
        const isOwner = currentUser && s.userId === currentUser.uid;
        const card = document.createElement('div');
        card.className='card';
        
        // Ø¹Ø±Ø¶ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¥Ù† ÙˆØ¬Ø¯
        const ratingHtml = s.averageRating ? `
          <div class="rating">
            ${renderStars(Math.round(s.averageRating))}
            <span style="color:#666;margin-right:5px">(${s.totalReviews || 0})</span>
          </div>
        ` : '<div style="color:#777;font-size:0.9rem">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</div>';
        
        card.innerHTML = `
          ${s.imageUrl ? `<img src="${s.imageUrl}" alt="${s.name}"/>` : ``}
          <h3 style="margin:.3rem 0">${s.name}</h3>
          <div class="meta"><span>ğŸ·ï¸ ${s.category}</span><span>ğŸ“ ${s.location}</span></div>
          ${ratingHtml}
          <p><b>Ø§Ù„Ø£ÙˆØ±Ø§Ù‚:</b> ${escapeHTML(s.documents||'')}</p>
          ${s.cost && s.cost!=='ØºÙŠØ± Ù…Ø­Ø¯Ø¯' ? `<p><b>Ø§Ù„ØªÙƒÙ„ÙØ©:</b> ${escapeHTML(s.cost)}</p>`:''}
          ${s.duration && s.duration!=='ØºÙŠØ± Ù…Ø­Ø¯Ø¯' ? `<p><b>Ø§Ù„Ù…Ø¯Ø©:</b> ${escapeHTML(s.duration)}</p>`:''}
          ${s.notes ? `<p><b>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</b> ${escapeHTML(s.notes)}</p>`:''}
          <small style="display:block;margin-top:8px;color:#666">Ø£Ø¶ÙŠÙØª Ø¨ÙˆØ§Ø³Ø·Ø©: ${s.userEmail || 'â€”'}</small>
          <div class="f-end" style="margin-top:10px">
            <button class="btn btn-primary btn-icon" onclick="openReview('${s.id}')">
              <i class="fas fa-star"></i> Ù‚ÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©
            </button>
            ${isOwner ? `<button class="btn btn-danger btn-icon" data-id="${s.id}">ğŸ—‘ï¸ Ø­Ø°Ù</button>`:''}
          </div>
        `;
        // Ø¥Ø±ÙØ§Ù‚ Ø­Ø¯Ø« Ø§Ù„Ø­Ø°Ù Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø§Ù„Ùƒ
        if(isOwner){
          const delBtn = card.querySelector('button.btn-danger');
          delBtn.addEventListener('click', ()=>confirmDelete(s));
        }
        wrap.appendChild(card);
      });
    }

    function escapeHTML(str){
      return String(str).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    async function confirmDelete(svc){
      if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø£ÙŠØ¶Ø§Ù‹ Ø¥Ù† ÙˆØ¬Ø¯Øª.')) return;
      try{
        // 1) Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯
        await deleteDoc(doc(db,'services', svc.id));
        // 2) Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù† ÙˆÙØ¬Ø¯Øª
        if(svc.imagePath){
          try{ await deleteObject(sRef(storage, svc.imagePath)); }catch(e){ console.warn('Image delete warning:', e.message); }
        }
        toast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø©'); loadServices(); loadStats();
      }catch(err){ console.error(err); toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù: '+err.message,'error'); }
    }

    /* ==== Stats ==== */
    async function loadStats(){
      try{
        const servicesSnap = await getDocs(collection(db,'services'));
        $('#statServices').textContent = servicesSnap.size;

        const users = new Set();
        let totalReviews = 0;
        
        servicesSnap.forEach(d=>{ 
          const data = d.data();
          const u = data.userId; 
          if(u) users.add(u);
          totalReviews += data.totalReviews || 0;
        });
        
        $('#statUsers').textContent = users.size;
        $('#statReviews').textContent = totalReviews;
      }catch(e){
        $('#statServices').textContent='0'; $('#statUsers').textContent='0'; $('#statReviews').textContent='0';
      }
    }

    /* ==== Global keys (Esc closes modals) ==== */
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Escape'){ 
        $('#authModal').classList.remove('active'); 
        $('#addModal').classList.remove('active'); 
        $('#reviewModal').classList.remove('active');
      }
    });
    document.querySelectorAll('.modal').forEach(m=>{
      m.addEventListener('click', (e)=>{ if(e.target===m) m.classList.remove('active'); });
    });
    
    // Ø¬Ø¹Ù„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ… Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
    window.searchServices = searchServices;
    window.openReview = openReview;
    window.closeReview = closeReview;
  </script>
</body>
</html>
